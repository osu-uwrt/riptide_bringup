<launch>
      <arg name="robot" default="puddles" doc="Which robot to simulate" />

      <!-- Launch Simulator -->
      <node name="simulator" pkg="riptide_bringup" type="launch_sim.sh" />

      <!-- TCP connection -->
      <rosparam file="$(find ros_tcp_endpoint)/config/params.yaml" command="load"/>
      <node name="server_endpoint" pkg="ros_tcp_endpoint" type="default_server_endpoint.py" args="--wait" output="screen" respawn="true" />
      
      <!-- Start rest of software -->
      <group ns="$(arg robot)">
            <param name="robot_description"
            command="$(find xacro)/xacro '$(find riptide_descriptions)/robots/$(arg robot).xacro'
                    debug:=0
                    namespace:=$(arg robot)
                    inertial_reference_frame:=world" />
            
            <include file="$(find riptide_controllers)/launch/controller.launch">
                  <arg name="robot" value="$(arg robot)" />
            </include> 
            <include file="$(find riptide_teleop)/launch/ps3_teleop.launch" > 
                  <arg name="robot" value="$(arg robot)" />
            </include>  
            <include file="$(find riptide_localization)/launch/navigation.launch">
                  <arg name="namespace" value="$(arg robot)" />
            </include>
            <include file="$(find riptide_mapping)/launch/mapping.launch">
                  <arg name="namespace" value="$(arg robot)" />
            </include>        
            <include file="$(find riptide_hardware)/launch/diagnostics.launch">
                  <arg name="robot" value="$(arg robot)" />
            </include>
      </group>
      <include file="$(find flexbe_onboard)/launch/behavior_onboard.launch"/>
</launch>
